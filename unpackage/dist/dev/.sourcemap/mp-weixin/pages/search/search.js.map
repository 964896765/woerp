{"version":3,"sources":["uni-app:///main.js",null,"webpack:///C:/Users/chejun/Desktop/woerp/pages/search/search.vue?bba5","webpack:///C:/Users/chejun/Desktop/woerp/pages/search/search.vue?af22","webpack:///C:/Users/chejun/Desktop/woerp/pages/search/search.vue?5769","uni-app:///pages/search/search.vue","webpack:///C:/Users/chejun/Desktop/woerp/pages/search/search.vue?19fb","webpack:///C:/Users/chejun/Desktop/woerp/pages/search/search.vue?aa99"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","customKeyboard","data","kw","placeholder","hotKeys","history","results","kwSearched","isSearching","cartList","showCartModal","showQtyPopup","qtyStr","currentType","currentMaterial","materialSearch","bottomPadRpx","scrollInto","tabIndex","swiperDisable","_axisIntent","_sx","_sy","tabList","id","name","nid","computed","validQty","onLoad","mounted","uni","success","methods","switchTab","onSwiperChange","onAxisStart","onAxisMove","onAxisEnd","goBack","uiUtils","onInput","clearKw","doSearch","arr","setTimeout","pickHot","pickHistory","removeHistory","clearHistory","chooseTypeAndQty","cancelQuantity","confirmQuantity","materialCode","materialName","type","quantity","timestamp","delta","goToCheckout","url","loadCartList","removeCartItem","getTotalQuantity","showCartDetail","closeCartModal","noop"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,eAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+H;AAC/H;AAC0D;AACL;AACsC;;;AAG3F;AACoL;AACpL,gBAAgB,6LAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,6FAAM;AACR,EAAE,sGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,iGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,kOAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACtDA;AAAA;AAAA;AAAA;AAA2qB,CAAgB,gsBAAG,EAAC,C;;;;;;;;;;;;;;;;;;ACqH/rB;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eAGA;EACAC;IACAC;EACA;EACAC;IACA;MACAC;MAAAC;MACAC;MACAC;MAAAC;MAAAC;MAAAC;MACA;MACAC;MAAAC;MACA;MACAC;MAAAC;MAAAC;MAAAC;MACA;MACAC;MACA;MACAC;MAAA;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC,UACA;QAAAC;QAAAC;QAAAC;MAAA,GACA;QAAAF;QAAAC;QAAAC;MAAA;IAEA;EACA;EACAC;IACAC;MACA;MACA;MACA;IACA;EACA;EACAC;IACA;IACA;IACA;EACA;EACAC;IAAA;IACA;IACAC;MACAC;QACA;QACA;QACA;QACA;QACA;QACA;MACA;IACA;EACA;EACAC;IACA;IACAC;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACA;QAAA;QACA;QACA;MACA;QACA;QACA;MACA;IACA;IACAC;MACA;MACA;IACA;IAEAC;MAAAC;IAAA;IACAC;MAAA;QAAA;QAAA;MAAA;IAAA;IACAC;MAAA;MAAA;MAAA;IAAA;IAEAC;MAAA;MACA;MACA;QAAAH;QAAA;MAAA;;MAEA;MACA;MACA;;MAEA;MACA;QAAA;MAAA;MACAI;MACA;MACAb;;MAEA;MACAc;QACA;QACA;QACA;QAEA;UACAL;QACA;MACA;IACA;IAEAM;MAAA;MAAA;IAAA;IACAC;MAAA;MAAA;IAAA;IACAC;MAAA;MAAAjB;IAAA;IACAkB;MAAA;MAAAlB;IAAA;IAEA;IACAmB;MACA;MACA;MACA;MACA;IACA;IAEAC;MACA;MACA;MACA;IACA;IAEAC;MACA;;MAEA;MACA;QACA5B;QACA6B;QACAC;QACAC;QACAC;QACAC;QACAC;MACA;;MAEA;MACA;MACAjD;;MAEA;MACAsB;MACA;MAEA;MACA;MACA;MAEAS;IACA;IAEA;IACAmB;MACA5B;QACA6B;MACA;IACA;IAEA;IACAC;MAAA;IAAA;IACAC;MAAA;QAAA;MAAA;MAAA/B;IAAA;IACAgC;MACA;QAAA;MAAA;MACA;IACA;IACAC;MAAA;IAAA;IACAC;MAAA;MAAAlC;IAAA;IACAmC;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACvTA;AAAA;AAAA;AAAA;AAA0yC,CAAgB,uwCAAG,EAAC,C;;;;;;;;;;;ACA9zC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/search/search.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/search/search.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./search.vue?vue&type=template&id=4cedc0c6&scoped=true&\"\nvar renderjs\nimport script from \"./search.vue?vue&type=script&lang=js&\"\nexport * from \"./search.vue?vue&type=script&lang=js&\"\nimport style0 from \"./search.vue?vue&type=style&index=0&id=4cedc0c6&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4cedc0c6\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/search/search.vue\"\nexport default component.exports","export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=template&id=4cedc0c6&scoped=true&\"","var components\ntry {\n  components = {\n    customKeyboard: function () {\n      return import(\n        /* webpackChunkName: \"components/custom-keyboard/custom-keyboard\" */ \"@/components/custom-keyboard/custom-keyboard.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. æ’æŸ¥ç»„ä»¶åç§°æ‹¼å†™æ˜¯å¦æ­£ç¡®\")\n    console.error(\n      \"2. æ’æŸ¥ç»„ä»¶æ˜¯å¦ç¬¦åˆ easycom è§„èŒƒï¼Œæ–‡æ¡£ï¼šhttps://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. è‹¥ç»„ä»¶ä¸ç¬¦åˆ easycom è§„èŒƒï¼Œéœ€æ‰‹åŠ¨å¼•å…¥ï¼Œå¹¶åœ¨ components ä¸­æ³¨å†Œè¯¥ç»„ä»¶\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.kwSearched ? _vm.results.length : null\n  var g1 = _vm.kwSearched && g0 ? _vm.results.length : null\n  var g2 = _vm.kwSearched ? _vm.results.length : null\n  var g3 = _vm.history.length\n  var g4 = _vm.history.length\n  var g5 = _vm.cartList.length\n  var g6 = g5 > 0 ? _vm.cartList.length : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        g2: g2,\n        g3: g3,\n        g4: g4,\n        g5: g5,\n        g6: g6,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=script&lang=js&\"","<template>\n  <view class=\"search-page\" @touchstart=\"onAxisStart\" @touchmove=\"onAxisMove\" @touchend=\"onAxisEnd\" @touchcancel=\"onAxisEnd\">\n    <!-- é¡¶éƒ¨æœç´¢æ  -->\n    <view class=\"search-head\">\n      <text class=\"back-btn\" @tap=\"goBack\">â†</text>\n      <view class=\"search-input\">\n        <text class=\"search-icon\">ğŸ”</text>\n        <input\n          class=\"ipt\"\n          v-model=\"kw\"\n          type=\"text\"\n          :placeholder=\"placeholder\"\n          confirm-type=\"search\"\n          @confirm=\"doSearch\"\n          @input=\"onInput\"\n        />\n        <text v-if=\"kw\" class=\"clear-icon\" @tap=\"clearKw\">Ã—</text>\n      </view>\n      <text class=\"btn\" @tap=\"doSearch\">æœç´¢</text>\n    </view>\n    \n    <!-- åˆ†ç±»æ ‡ç­¾æ  -->\n    <scroll-view class=\"tabbar\" :scroll-x=\"true\" :show-scrollbar=\"false\" :scroll-into-view=\"scrollInto\" enable-flex>\n      <view v-for=\"(tab, i) in tabList\" :key=\"tab.id\" :id=\"'tab-' + i\" class=\"tab\" @tap=\"switchTab(i)\">\n        <text :class=\"['tab-text', i===tabIndex?'active':'']\">{{ tab.name }}</text>\n      </view>\n    </scroll-view>\n    \n    <!-- å†…å®¹åŒºåŸŸ - ä½¿ç”¨swiperå®ç°æ¨ªå‘æ»‘åŠ¨ -->\n    <swiper class=\"swiper\" :current=\"tabIndex\" :duration=\"300\" :disable-touch=\"swiperDisable\" @change=\"onSwiperChange\">\n      <swiper-item>\n        <scroll-view scroll-y class=\"search-scroll\" :style=\"{ paddingBottom: bottomPadRpx, height: '100%' }\">\n          <!-- æœç´¢ä¸­çŠ¶æ€ -->\n          <view v-if=\"isSearching\" class=\"search-loading\">\n            <text class=\"loading-icon\">â³</text>\n            <text class=\"loading-text\">æ­£åœ¨æœç´¢ä¸­...</text>\n          </view>\n\n          <!-- ç»“æœç½®é¡¶ -->\n          <view class=\"block\" v-if=\"kwSearched\">\n            <view class=\"block-title\">\n              <text>æœç´¢ç»“æœ</text>\n              <text class=\"result-count\" v-if=\"results.length\">({{ results.length }}ä¸ªç»“æœ)</text>\n            </view>\n            <view v-if=\"results.length\" class=\"result-list\">\n              <view class=\"res-row\" v-for=\"m in results\" :key=\"m.id\">\n                <text class=\"list-icon\">ğŸ“‹</text>\n                <view class=\"material-info\">\n                  <text class=\"name\">{{ m.code }} - {{ m.name }}</text>\n                  <text class=\"detail\">åº“å­˜: {{ m.stock }}{{ m.unit }} | {{ m.category }}</text>\n                </view>\n                <view class=\"ops\">\n                  <view class=\"op-btn op-btn-add\" @tap=\"chooseTypeAndQty(m, 'inbound')\">+</view>\n                  <view class=\"op-btn op-btn-minus\" @tap=\"chooseTypeAndQty(m, 'outbound')\">-</view>\n                </view>\n              </view>\n            </view>\n            <view v-else class=\"empty\">\n              <text class=\"empty-icon\">ğŸ”</text>\n              <text class=\"t\">æ²¡æœ‰æ‰¾åˆ°ç›¸å…³ææ–™</text>\n              <text class=\"empty-tip\">å°è¯•ä½¿ç”¨å…¶ä»–å…³é”®è¯æœç´¢</text>\n            </view>\n          </view>\n\n          <!-- çƒ­é—¨æœç´¢ -->\n          <view class=\"block\">\n            <view class=\"block-title\">çƒ­é—¨æœç´¢</view>\n            <view class=\"chips\">\n              <view v-for=\"(h,i) in hotKeys\" :key=\"`hot-${i}`\" class=\"chip\" @tap=\"pickHot(h)\">{{ h }}</view>\n            </view>\n          </view>\n        </scroll-view>\n      </swiper-item>\n      \n      <swiper-item>\n        <scroll-view scroll-y class=\"search-scroll\" :style=\"{ paddingBottom: bottomPadRpx, height: '100%' }\">\n          <!-- æœç´¢å†å² -->\n          <view class=\"block\">\n            <view class=\"block-title history-title\">\n              <text>æœç´¢å†å²</text>\n              <text class=\"clear-all\" v-if=\"history.length\" @tap=\"clearHistory\">æ¸…ç©º</text>\n            </view>\n\n            <view v-if=\"history.length\" class=\"history-list\">\n              <view class=\"his-row\" v-for=\"(h,i) in history\" :key=\"i\">\n                <view class=\"his-left\" @tap=\"pickHistory(h)\">\n                  <text class=\"clock-icon\">ğŸ•</text>\n                  <text class=\"his-text\">{{ h }}</text>\n                </view>\n                <view class=\"del\" @tap.stop=\"removeHistory(i)\"><text class=\"del-icon\">Ã—</text></view>\n              </view>\n            </view>\n            <view v-else class=\"empty-small\">æš‚æ— å†å²</view>\n          </view>\n        </scroll-view>\n      </swiper-item>\n    </swiper>\n\n    <!-- è´­ç‰©è½¦å›¾æ ‡ -->\n    <view v-if=\"cartList.length > 0\" class=\"cart-fab\" @click=\"goToCheckout\">\n      <text class=\"cart-icon\">ğŸ›’</text>\n      <view class=\"cart-badge\">{{ cartList.length }}</view>\n    </view>\n\n    <!-- è‡ªå®šä¹‰é”®ç›˜ç»„ä»¶ -->\n    <custom-keyboard\n      :show.sync=\"showQtyPopup\"\n      :materialInfo=\"currentMaterial\"\n      :operationType=\"currentType\"\n      v-model=\"qtyStr\"\n      @confirm=\"confirmQuantity\"\n      @cancel=\"cancelQuantity\"\n    />\n  </view>\n</template>\n\n<script>\nimport { materialSearch } from '@/common/materialData.js'\nimport { uiUtils } from '@/common/util.js'\nimport customKeyboard from '@/components/custom-keyboard/custom-keyboard.vue'\n\nexport default {\n  components: {\n    customKeyboard\n  },\n  data(){\n    return {\n      kw:'', placeholder:'è¾“å…¥ç‰©æ–™ç¼–ç /åç§°',\n      hotKeys:[],\n      history:[], results:[], kwSearched:false, isSearching:false,\n      // æ¸…å•\n      cartList:[], showCartModal:false,\n      // æ•°é‡\n      showQtyPopup:false, qtyStr:'', currentType:'inbound', currentMaterial:null,\n      // æœç´¢å®ä¾‹\n      materialSearch: materialSearch,\n      // åº•éƒ¨å®‰å…¨åŒºå†…è¾¹è·\n      bottomPadRpx: '100rpx', // é»˜è®¤å…œåº•ï¼šè‡³å°‘ 100rpx\n      // æ¨ªå‘æ»‘åŠ¨ç›¸å…³\n      scrollInto: '',\n      tabIndex: 0,\n      swiperDisable: false,\n      _axisIntent: null,\n      _sx: 0,\n      _sy: 0,\n      tabList: [\n        { id: 'tab01', name: 'æœç´¢', nid: 0 },\n        { id: 'tab02', name: 'å†å²', nid: 1 }\n      ]\n    }\n  },\n  computed:{\n    validQty(){\n      if (!this.qtyStr) return false\n      if (!/^\\d+(\\.\\d{0,2})?$/.test(this.qtyStr)) return false\n      return parseFloat(this.qtyStr) > 0\n    }\n  },\n  onLoad(){\n    this.history = uni.getStorageSync('search_history') || []\n    this.hotKeys = this.materialSearch.getHotKeys()\n    this.loadCartList()\n  },\n  mounted() {\n    // è®¡ç®—å®‰å…¨åŒº bottomï¼ˆpxï¼‰â†’ rpxï¼Œå† +100rpx\n    uni.getSystemInfo({\n      success: (info) => {\n        // å®‰å…¨åŒºï¼šApp/H5 æœ‰ safeAreaInsetsï¼Œå­—èŠ‚ç«¯å¯èƒ½æ²¡æœ‰\n        const insetPx = (info.safeAreaInsets && info.safeAreaInsets.bottom) ? info.safeAreaInsets.bottom : 0\n        const rpxPerPx = 750 / info.windowWidth  // px -> rpx\n        const insetRpx = Math.round(insetPx * rpxPerPx)\n        const totalRpx = insetRpx + 100\n        this.bottomPadRpx = `${totalRpx}rpx`\n      }\n    })\n  },\n  methods:{\n    // æ¨ªå‘æ»‘åŠ¨ç›¸å…³æ–¹æ³•\n    switchTab(i) {\n      if (i === this.tabIndex) return\n      this.tabIndex = i\n      this.scrollInto = 'tab-' + i\n    },\n    onSwiperChange(e) {\n      const i = (e && e.detail && typeof e.detail.current === 'number') ? e.detail.current : 0\n      this.tabIndex = i\n      this.scrollInto = 'tab-' + i\n    },\n    // è½´å‘é”ï¼šé¿å…æ¨ªçºµå†²çª\n    onAxisStart(e){\n      const t = (e.touches && e.touches[0]) || e\n      this._sx = t.pageX || t.clientX || 0\n      this._sy = t.pageY || t.clientY || 0\n      this._axisIntent = null\n      this.swiperDisable = false\n    },\n    onAxisMove(e){\n      if (this._axisIntent) return\n      const t = (e.touches && e.touches[0]) || e\n      const dx = Math.abs((t.pageX||t.clientX||0) - this._sx)\n      const dy = Math.abs((t.pageY||t.clientY||0) - this._sy)\n      const TH = 12\n      if (dy > dx && dy > TH) { // çºµå‘ä¸ºä¸» â†’ ç¦æ­¢ swiper æ¥æ‰‹\n        this._axisIntent = 'y'\n        this.swiperDisable = true\n      } else if (dx > dy && dx > TH) {\n        this._axisIntent = 'x'\n        this.swiperDisable = false\n      }\n    },\n    onAxisEnd(){ \n      this._axisIntent = null\n      this.swiperDisable = false \n    },\n    \n    goBack(){ uiUtils.goBack() },\n    onInput(){ if(!this.kw){ this.kwSearched=false; this.results=[] } },\n    clearKw(){ this.kw=''; this.kwSearched=false; this.results=[] },\n\n    doSearch(){\n      const k = (this.kw||'').trim()\n      if(!k){ uiUtils.showToast('è¯·è¾“å…¥å…³é”®è¯'); return }\n\n      // æ˜¾ç¤ºæœç´¢ä¸­çŠ¶æ€\n      this.isSearching = true\n      this.kwSearched = false\n\n      // å†™å…¥å†å²ï¼šå»é‡ç½®é¡¶\n      const arr = this.history.filter(v=>v!==k)\n      arr.unshift(k)\n      this.history = arr.slice(0,20)\n      uni.setStorageSync('search_history', this.history)\n\n      // ä½¿ç”¨æ–°çš„æœç´¢åŠŸèƒ½\n      setTimeout(() => {\n        this.results = this.materialSearch.search(k)\n        this.kwSearched = true\n        this.isSearching = false\n\n        if (this.results.length === 0) {\n          uiUtils.showToast('æœªæ‰¾åˆ°ç›¸å…³ç‰©æ–™')\n        }\n      }, 300) // æ¨¡æ‹Ÿæœç´¢å»¶è¿Ÿï¼Œæå‡ç”¨æˆ·ä½“éªŒ\n    },\n\n    pickHot(h){ this.kw=h; this.doSearch() },\n    pickHistory(h){ this.kw=h; this.doSearch() },\n    removeHistory(i){ this.history.splice(i,1); uni.setStorageSync('search_history', this.history) },\n    clearHistory(){ this.history=[]; uni.removeStorageSync('search_history') },\n\n    // å‡º/å…¥åº“\n    chooseTypeAndQty(m, t){\n      this.currentMaterial = m\n      this.currentType = t\n      this.qtyStr = ''\n      this.showQtyPopup = true\n    },\n\n    cancelQuantity() {\n      this.showQtyPopup = false\n      this.qtyStr = ''\n      this.currentMaterial = null\n    },\n\n    confirmQuantity(data) {\n      if (!data || !data.material) return\n\n      // æ·»åŠ åˆ°è´­ç‰©è½¦é€»è¾‘ - ä½¿ç”¨ä¸materialé¡µé¢ç›¸åŒçš„ç»“æ„\n      const cartItem = {\n        id: Date.now(),\n        materialCode: data.material.code,\n        materialName: data.material.name,\n        type: data.type,\n        quantity: data.quantity,\n        timestamp: new Date().getTime(),\n        delta: data.type === 'inbound' ? data.quantity : -data.quantity\n      }\n\n      // è·å–å½“å‰è´­ç‰©è½¦åˆ—è¡¨å¹¶æ·»åŠ æ–°é¡¹ç›®\n      let cartList = uni.getStorageSync('cartList') || []\n      cartList.push(cartItem)\n      \n      // ä¿å­˜åˆ°å…±äº«å­˜å‚¨\n      uni.setStorageSync('cartList', cartList)\n      this.cartList = cartList\n\n      this.showQtyPopup = false\n      this.qtyStr = ''\n      this.currentMaterial = null\n\n      uiUtils.showSuccess('å·²æ·»åŠ åˆ°æ¸…å•')\n    },\n\n    // è·³è½¬åˆ°ç»“ç®—é¡µé¢\n    goToCheckout() {\n      uni.navigateTo({\n        url: '/pages/checkout/checkout'\n      })\n    },\n\n    // æ¸…å•\n    loadCartList(){ this.cartList = uni.getStorageSync('cartList') || [] },\n    removeCartItem(id){ this.cartList = this.cartList.filter(x=>x.id!==id); uni.setStorageSync('cartList', this.cartList) },\n    getTotalQuantity(){\n      const t=this.cartList.reduce((s,x)=>s+Number(x.quantity||0),0)\n      return Number.isInteger(t)?t:t.toFixed(2)\n    },\n    showCartDetail(){ this.showCartModal=true },\n    closeCartModal(){ this.showCartModal=false; uni.setStorageSync('cartList', this.cartList) },\n    noop(){}\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.search-page{ \n  height: 100vh; \n  background:#fff; \n  display:flex; \n  flex-direction:column;\n  /* å®‰å…¨åŒºåŸŸé€‚é… */\n  padding-top: constant(safe-area-inset-top);\n  padding-top: env(safe-area-inset-top);\n  padding-bottom: constant(safe-area-inset-bottom);\n  padding-bottom: env(safe-area-inset-bottom);\n  /* æ‰‹åŠ¨è®¾ç½®å®‰å…¨åŒºåŸŸ */\n  padding-top: 35px;\n  padding-bottom: 15px;\n  box-sizing: border-box;\n  overflow: hidden;\n}\n\n/* æ ‡ç­¾æ æ ·å¼ */\n.tabbar { \n  height: 88rpx; \n  min-height: 44px;\n  background: #fff; \n  border-bottom: 1px solid #eef0f4; \n  white-space: nowrap; \n  display: flex; \n  align-items: center;\n  flex-shrink: 0;\n  overflow-x: auto;\n  -webkit-overflow-scrolling: touch;\n}\n\n.tab { \n  display: inline-flex; \n  padding: 0 28rpx; \n  min-width: 120rpx;\n  height: 88rpx; \n  align-items: center; \n  justify-content: center;\n  flex-shrink: 0;\n}\n\n.tab-text { \n  font-size: 32rpx; \n  color: #555; \n  line-height: 88rpx;\n  white-space: nowrap;\n}\n\n.tab-text.active { \n  color: #ff4d4f; \n  font-weight: 800; \n}\n/* Swiperæ ·å¼ */\n.swiper {\n  flex: 1;\n  height: 0;\n  overflow: hidden;\n}\n\n.swiper ::v-deep .uni-swiper-wrapper,\n.swiper ::v-deep .uni-swiper-slide {\n  height: 100%;\n  overflow: hidden;\n}\n\n.search-scroll {\n  height: 100%;\n}\n\n.search-head {\n  height: 96rpx; display:flex; align-items:center; gap: 16rpx;\n  padding: 0 16rpx; border-bottom: 1rpx solid #f2f2f2;\n  width: 70%; /* è¿›ä¸€æ­¥æ¨ªå‘æ”¶ç¼©ï¼Œé¿å¼€å³ä¾§å°ç¨‹åºåŸç”ŸæŒ‰é’® */\n  margin-right: auto;\n  \n  .search-input{\n    flex:1; min-width:0; display:flex; align-items:center; gap: 10rpx;\n    background:#f6f7f9; border-radius: 999rpx; padding: 10rpx 16rpx;\n    .ipt{ flex:1; min-width:0; font-size: 26rpx; }\n  }\n  .btn{ color:#3c9cff; }\n}\n\n.back-btn {\n  font-size: 36rpx;\n  color: #333;\n  padding: 10rpx;\n}\n\n.search-icon, .clear-icon, .list-icon, .clock-icon {\n  font-size: 24rpx;\n  color: #999;\n}\n\n.clear-icon {\n  font-size: 32rpx;\n  color: #ccc;\n  padding: 4rpx;\n}\n\n.del-icon {\n  font-size: 28rpx;\n  color: #bbb;\n}\n\n.empty-icon {\n  font-size: 88rpx;\n  margin-bottom: 16rpx;\n}\n.search-scroll{ flex:1; min-height:0; overflow:auto; padding: 12rpx 16rpx 0; }\n.block{ margin-top: 18rpx; }\n.block-title{ font-size: 28rpx; font-weight: 700; color:#333; margin: 8rpx 0 14rpx; display:flex; align-items:center; justify-content:space-between; }\n.history-title .clear-all{ color:#3c9cff; font-size: 26rpx; padding: 6rpx 8rpx; }\n\n.chips{ display:flex; flex-wrap:wrap; gap: 14rpx; }\n.chip{ padding: 10rpx 22rpx; border-radius: 999rpx; background:#f6f7f9; color:#555; }\n\n/* å†å²åˆ—è¡¨ */\n.history-list{\n  background:#fff;\n  .his-row{\n    height: 88rpx; display:flex; align-items:center; justify-content:space-between;\n    border-bottom:1rpx solid #f2f2f2;\n    .his-left{ display:flex; align-items:center; gap: 12rpx; }\n    .his-text{ font-size: 28rpx; color:#333; }\n    .del{ padding: 18rpx; margin-right: -10rpx; }\n  }\n}\n.empty-small{ height: 120rpx; display:flex; align-items:center; color:#bbb; padding-left: 4rpx; }\n\n/* ç»“æœåˆ—è¡¨ï¼šå•æ¡çº¿ */\n.result-list{\n  background:#fff;\n  .res-row{\n    min-height: 88rpx; display:flex; align-items:center; gap: 12rpx;\n    padding: 12rpx 4rpx; border-top:1rpx solid #e6e6e6;\n  }\n  .res-row:first-child{ border-top: 0; }\n  .name{ flex:1; min-width:0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }\n  .ops{ display:inline-flex; gap: 10rpx; }\n  .op-btn {\n    width: 60rpx;\n    height: 60rpx;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 28rpx;\n    font-weight: 600;\n    color: #fff;\n  }\n  .op-btn-add {\n    background: #52c41a;\n  }\n  .op-btn-minus {\n    background: #ff4d4f;\n  }\n}\n\n.empty{ height: 200rpx; display:flex; flex-direction:column; align-items:center; justify-content:center; color:#bbb; }\n.empty .t{ margin-top: 12rpx; font-size: 26rpx; }\n.empty-tip{ margin-top: 8rpx; font-size: 24rpx; color: #999; }\n\n/* æœç´¢åŠ è½½çŠ¶æ€ */\n.search-loading {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 120rpx 0;\n  color: #999;\n}\n\n.loading-icon {\n  font-size: 64rpx;\n  margin-bottom: 16rpx;\n  animation: spin 1s linear infinite;\n}\n\n.loading-text {\n  font-size: 28rpx;\n}\n\n@keyframes spin {\n  from { transform: rotate(0deg); }\n  to { transform: rotate(360deg); }\n}\n\n/* ç»“æœç»Ÿè®¡ */\n.result-count {\n  font-size: 24rpx;\n  color: #666;\n  font-weight: normal;\n}\n\n/* ç‰©æ–™ä¿¡æ¯å±•ç¤ºä¼˜åŒ– */\n.material-info {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 4rpx;\n}\n\n.material-info .name {\n  font-size: 30rpx;\n  font-weight: 600;\n  color: #333;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.material-info .detail {\n  font-size: 24rpx;\n  color: #999;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.cart-fab {\n  position: fixed;\n  right: 30rpx;\n  bottom: 30rpx;\n  width: 96rpx;\n  height: 96rpx;\n  background: #4da3ff;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 10rpx 26rpx rgba(0,0,0,.16);\n  z-index: 100;\n}\n\n.cart-icon {\n  color: #fff;\n  font-size: 42rpx;\n}\n\n.cart-badge {\n  position: absolute;\n  right: -6rpx;\n  top: -6rpx;\n  background: #ff4d4f;\n  color: #fff;\n  font-size: 22rpx;\n  border-radius: 50%;\n  min-width: 32rpx;\n  height: 32rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 0 8rpx;\n}\n\n/* ç§»åŠ¨ç«¯å“åº”å¼æ ·å¼ */\n@media screen and (max-width: 480px) {\n  .search-head {\n    height: 88rpx;\n    padding: 0 12rpx;\n    gap: 12rpx;\n    \n    .search-input {\n      padding: 8rpx 12rpx;\n      \n      .ipt {\n        font-size: 24rpx;\n      }\n    }\n    \n    .btn {\n      font-size: 26rpx;\n    }\n  }\n  \n  .back-btn {\n    font-size: 32rpx;\n    padding: 8rpx;\n  }\n  \n  .search-scroll {\n    padding: 10rpx 12rpx 0;\n  }\n  \n  .block {\n    margin-top: 16rpx;\n  }\n  \n  .hd {\n    font-size: 26rpx;\n    padding: 16rpx 0 12rpx;\n  }\n  \n  .item {\n    padding: 16rpx 0;\n    \n    .name {\n      font-size: 26rpx;\n    }\n    \n    .code {\n      font-size: 22rpx;\n    }\n  }\n  \n  .cart-fab {\n    width: 100rpx;\n    height: 100rpx;\n    bottom: 120rpx;\n    right: 30rpx;\n  }\n  \n  .cart-icon {\n    font-size: 38rpx;\n  }\n  \n  .cart-badge {\n    font-size: 20rpx;\n    min-width: 28rpx;\n    height: 28rpx;\n  }\n}\n\n@media screen and (max-width: 375px) {\n  .search-head {\n    height: 80rpx;\n    padding: 0 10rpx;\n    gap: 10rpx;\n    \n    .search-input {\n      padding: 6rpx 10rpx;\n      \n      .ipt {\n        font-size: 22rpx;\n      }\n    }\n    \n    .btn {\n      font-size: 24rpx;\n    }\n  }\n  \n  .back-btn {\n    font-size: 30rpx;\n    padding: 6rpx;\n  }\n  \n  .search-scroll {\n    padding: 8rpx 10rpx 0;\n  }\n  \n  .block {\n    margin-top: 14rpx;\n  }\n  \n  .hd {\n    font-size: 24rpx;\n    padding: 14rpx 0 10rpx;\n  }\n  \n  .item {\n    padding: 14rpx 0;\n    \n    .name {\n      font-size: 24rpx;\n    }\n    \n    .code {\n      font-size: 20rpx;\n    }\n  }\n  \n  .cart-fab {\n    width: 90rpx;\n    height: 90rpx;\n    bottom: 100rpx;\n    right: 25rpx;\n  }\n  \n  .cart-icon {\n    font-size: 34rpx;\n  }\n  \n  .cart-badge {\n    font-size: 18rpx;\n    min-width: 24rpx;\n    height: 24rpx;\n  }\n}\n\n/* æ¨ªå±é€‚é… */\n@media screen and (orientation: landscape) and (max-height: 500px) {\n  .search-page {\n    padding-top: 20px;\n    padding-bottom: 10px;\n  }\n  \n  .search-head {\n    height: 70rpx;\n    padding: 0 10rpx;\n  }\n  \n  .cart-fab {\n    bottom: 80rpx;\n    right: 20rpx;\n  }\n}\n</style>\n","import mod from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=style&index=0&id=4cedc0c6&lang=scss&scoped=true&\"; export default mod; export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./search.vue?vue&type=style&index=0&id=4cedc0c6&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1763278094324\n      var cssReload = require(\"D:/Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}