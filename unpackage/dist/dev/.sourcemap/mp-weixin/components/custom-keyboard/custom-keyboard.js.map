{"version":3,"sources":["webpack:///C:/Users/chejun/Desktop/woerp/components/custom-keyboard/custom-keyboard.vue?71f0","webpack:///C:/Users/chejun/Desktop/woerp/components/custom-keyboard/custom-keyboard.vue?67d0","webpack:///C:/Users/chejun/Desktop/woerp/components/custom-keyboard/custom-keyboard.vue?8f76","webpack:///C:/Users/chejun/Desktop/woerp/components/custom-keyboard/custom-keyboard.vue?b045","uni-app:///components/custom-keyboard/custom-keyboard.vue","webpack:///C:/Users/chejun/Desktop/woerp/components/custom-keyboard/custom-keyboard.vue?38c0","webpack:///C:/Users/chejun/Desktop/woerp/components/custom-keyboard/custom-keyboard.vue?74e5"],"names":["name","props","value","type","default","show","materialInfo","operationType","data","keys","bottomOffsetPx","_onResize","watch","mounted","beforeDestroy","methods","tap","del","close","ok","uni","title","icon","material","quantity","_recalcPanelOffset","safeBottom","winH","q"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwI;AACxI;AACmE;AACL;AACqC;;;AAGnG;AACoL;AACpL,gBAAgB,6LAAU;AAC1B,EAAE,qFAAM;AACR,EAAE,sGAAM;AACR,EAAE,+GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,0GAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAorB,CAAgB,ysBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eC0BxsB;EACAA;EACAC;IACAC;MAAAC;MAAAC;IAAA;IAAA;IACAC;MAAAF;MAAAC;IAAA;IACAE;MAAAH;MAAAC;IAAA;IACAG;MAAAJ;MAAAC;IAAA;EACA;EACAI;IACA;MACAC;MACAC;MACAC;IACA;EACA;EACAC;IACAP;MAAA;MACA;QACA;UAAA;QAAA;MACA;QACA;MACA;IACA;EACA;EACAQ;IACA;EAAA,CAKA;EACAC,yCAIA;EACAC;IACAC;MACA;MACA;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MACA;QACAC;UACAC;UACAC;QACA;QACA;MACA;MACA;MACA;MACA;QACAC;QACApB;QACAqB;MACA;IACA;IAEA;IACAC;MAAA;MACA;MACA;QAAAC;MACA;QACA;QACAC;QACAD;MACA;MAEA;MACAE;QACA;UAAA;UAAA;QAAA;QACA;QACA;QACA;QACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AClHA;AAAA;AAAA;AAAA;AAA4/B,CAAgB,s/BAAG,EAAC,C;;;;;;;;;;;ACAhhC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/custom-keyboard/custom-keyboard.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./custom-keyboard.vue?vue&type=template&id=2b7e018c&scoped=true&\"\nvar renderjs\nimport script from \"./custom-keyboard.vue?vue&type=script&lang=js&\"\nexport * from \"./custom-keyboard.vue?vue&type=script&lang=js&\"\nimport style0 from \"./custom-keyboard.vue?vue&type=style&index=0&id=2b7e018c&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2b7e018c\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/custom-keyboard/custom-keyboard.vue\"\nexport default component.exports","export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./custom-keyboard.vue?vue&type=template&id=2b7e018c&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./custom-keyboard.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./custom-keyboard.vue?vue&type=script&lang=js&\"","<template>\n  <view v-if=\"show\">\n    <!-- 遮罩，阻止穿透 -->\n    <view class=\"kb-mask\" @touchmove.prevent @click=\"close\"></view>\n    <!-- 键盘面板 -->\n    <view class=\"kb-wrap\" :style=\"bottomOffsetPx ? ('transform: translateY(-' + bottomOffsetPx + 'px)') : ''\">\n      <view class=\"kb-title\">\n        <text>{{ materialInfo ? (materialInfo.name + '（' + materialInfo.code + '）') : '数量' }}</text>\n        <text class=\"kb-type\" :class=\"operationType === 'inbound' ? 'in' : 'out'\">{{ operationType === 'inbound' ? '入库' : '出库' }}</text>\n      </view>\n      <view class=\"kb-display\">{{ value || 0 }}</view>\n      <view class=\"kb-grid\">\n        <view class=\"kb-key\" v-for=\"k in keys\" :key=\"k\" @click=\"tap(k)\">{{ k }}</view>\n        <view class=\"kb-key\" @click=\"del\">⌫</view>\n        <view class=\"kb-key\" @click=\"tap('0')\">0</view>\n        <view class=\"kb-key\" @click=\"tap('.')\">.</view>\n      </view>\n      <view class=\"kb-actions\">\n        <button class=\"kb-btn cancel\" @click=\"close\">取消</button>\n        <button class=\"kb-btn ok\" @click=\"ok\">确定</button>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nexport default {\n  name: 'custom-keyboard',\n  props: {\n    value: { type: String, default: '' },  // Vue2 v-model\n    show: { type: Boolean, default: false },\n    materialInfo: { type: Object, default: null },\n    operationType: { type: String, default: 'inbound' }\n  },\n  data() {\n    return {\n      keys: ['1','2','3','4','5','6','7','8','9'],\n      bottomOffsetPx: 0,\n      _onResize: null\n    }\n  },\n  watch: {\n    show(v) {\n      if (v) {\n        this.$nextTick(() => this._recalcPanelOffset())\n      } else {\n        this.bottomOffsetPx = 0\n      }\n    }\n  },\n  mounted(){\n    // H5 环境下，窗口变化（旋转/软键盘影响）时，重新计算面板避让\n    // #ifdef H5\n    this._onResize = () => { if (this.show) this.$nextTick(() => this._recalcPanelOffset()) }\n    if (typeof window !== 'undefined') window.addEventListener('resize', this._onResize, { passive: true })\n    // #endif\n  },\n  beforeDestroy(){\n    // #ifdef H5\n    if (this._onResize && typeof window !== 'undefined') window.removeEventListener('resize', this._onResize)\n    // #endif\n  },\n  methods: {\n    tap(k) {\n      // 只允许一个小数点\n      if (k === '.' && String(this.modelValue || '').indexOf('.') !== -1) return\n      const next = String(this.value || '') + k\n      this.$emit('input', next)\n    },\n    del() {\n      const next = String(this.value || '').slice(0, -1)\n      this.$emit('input', next)\n    },\n    close() {\n      this.$emit('update:show', false)\n      this.$emit('cancel')\n    },\n    ok() {\n      if (!this.value || isNaN(Number(this.value))) {\n        uni.showToast({\n          title: '请输入有效数字',\n          icon: 'none'\n        })\n        return\n      }\n      const quantity = Number(this.value || 0)\n      this.$emit('update:show', false)\n      this.$emit('confirm', {\n        material: this.materialInfo,\n        type: this.operationType,\n        quantity\n      })\n    }\n    ,\n    // 重新计算键盘面板的上移位移，避免遮挡底部按钮或安全区域\n    _recalcPanelOffset(){\n      // 获取窗口高度与底部安全区\n      let winH = 0, safeBottom = 0\n      try {\n        const info = (uni.getWindowInfo && uni.getWindowInfo()) || uni.getSystemInfoSync()\n        winH = info.windowHeight || 0\n        safeBottom = (info.safeAreaInsets && info.safeAreaInsets.bottom) || 0\n      } catch(e){}\n\n      const q = uni.createSelectorQuery().in(this)\n      q.select('.kb-wrap').boundingClientRect(rect => {\n        if (!rect || !winH) { this.bottomOffsetPx = 0; return }\n        // 计算面板底部是否超出可视高度（考虑安全区与微距离）\n        const allowance = Math.max(8, safeBottom)\n        const overflow = rect.bottom - (winH - allowance)\n        this.bottomOffsetPx = overflow > 0 ? overflow : 0\n      }).exec()\n    }\n  }\n}\n</script>\n\n<style scoped>\n.kb-mask{\n  position: fixed; inset: 0;\n  background: rgba(0,0,0,.35);\n  z-index: 9998;\n}\n\n.kb-wrap{\n  position: fixed; left: 0; right: 0; bottom: 0;\n  background: #fff;\n  border-top-left-radius: 16rpx;\n  border-top-right-radius: 16rpx;\n  padding: 20rpx 24rpx calc(24rpx + env(safe-area-inset-bottom));\n  z-index: 9999;\n  box-shadow: 0 -10rpx 26rpx rgba(0,0,0,.10);\n  will-change: transform;\n  transform: translateY(0);\n}\n\n.kb-title{ flex-direction: row; justify-content: space-between; align-items: center; font-size: 28rpx; color:#333; margin-bottom: 12rpx; }\n.kb-type{ font-weight: 700; }\n.kb-type.in{ color:#3bb34a; }\n.kb-type.out{ color:#f26363; }\n\n.kb-display{\n  height: 72rpx; border: 1px solid #eee; border-radius: 10rpx;\n  font-size: 32rpx; align-items: center; justify-content: flex-end;\n  padding: 0 16rpx; margin-bottom: 16rpx;\n}\n\n.kb-grid{\n  display: grid;\n  grid-template-columns: repeat(3, 1fr);\n  gap: 12rpx;\n  padding: 12rpx 0;\n}\n\n.kb-key{\n  height: 88rpx;\n  background: #f5f7fa;\n  border-radius: 8rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 32rpx;\n  font-weight: 500;\n  transition: opacity 0.2s;\n}\n\n.kb-key:active{\n  opacity: 0.7;\n}\n\n.kb-actions{\n  flex-direction: row;\n  gap: 12rpx;\n  margin-top: 16rpx;\n}\n\n.kb-btn{\n  flex: 1;\n  height: 72rpx;\n  border-radius: 8rpx;\n  align-items: center;\n  justify-content: center;\n  font-size: 28rpx;\n}\n\n.kb-btn.cancel{\n  background: #f5f7fa;\n  color: #666;\n}\n\n.kb-btn.ok{\n  background: #3c9cff;\n  color: #fff;\n}\n</style>\n","import mod from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./custom-keyboard.vue?vue&type=style&index=0&id=2b7e018c&scoped=true&lang=css&\"; export default mod; export * from \"-!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\Program Files\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./custom-keyboard.vue?vue&type=style&index=0&id=2b7e018c&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1763277928875\n      var cssReload = require(\"D:/Program Files/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}